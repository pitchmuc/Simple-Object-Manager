"use strict";class Som{constructor(t,e,i=!0){function s(){let t=new WeakSet;return(e,i)=>{if("object"==typeof i&&null!==i){if(t.has(i))return;t.add(i)}return i}}if(this.data={},this.defaultvalue=e,"object"==typeof t&&t instanceof Som==!1){if(Array.isArray(t)&&t.length>0){let a=this.data;t.forEach(function(t){if(i)try{a=Object.assign(a,JSON.parse(JSON.stringify(t)))}catch(e){console.warn("issue assigning object, trying removing circular references."),a=Object.assign(a,JSON.parse(JSON.stringify(t,s())))}else a=Object.assign(a,t)})}else try{i?this.data=Object.assign({},JSON.parse(JSON.stringify(t))):this.data=t}catch(r){console.warn("issue assigning object, trying removing circular references."),this.data=Object.assign({},JSON.parse(JSON.stringify(t,s())))}}else if("object"==typeof t&&t instanceof Som==!0)try{this.data=Object.assign({},JSON.parse(JSON.stringify(t.data)))}catch(n){console.warn("issue assigning object, trying removing circular references."),this.data=Object.assign({},JSON.parse(JSON.stringify(t.data,s())))}}get(t,e){if(void 0===t||""==t)return this.data;if("string"==typeof t){for(var i=t.split("."),s=this.data,a=0;a<i.length&&void 0!=s;a++)s=Array.isArray(s)&&Math.abs(parseInt(i[a]))<=s.length?0>parseInt(i[a])?s[s.length-Math.abs(parseInt(i[a]))]:s[parseInt(i[a])]:Array.isArray(s)&&Math.abs(parseInt(i[a]))>s.length?e||this.defaultvalue||void 0:s[i[a]];return""===s||void 0===s&""==e?"":s||e||this.defaultvalue||void 0}}assign(t,e,i){void 0===e&&(e=i);let s="override"==arguments[3];if(void 0!==t&&""!=t&&"string"==typeof t)for(var a=t.split("."),r=this.data,n=0;n<a.length&&void 0!=r;n++)if("string"==typeof a[n]&&!0==isNaN(a[n])){if(Object(r).hasOwnProperty(a[n]))n==a.length-1?Array.isArray(r[a[n]])?s?r[a[n]]=e:r[a[n]].push(e):r[a[n]]=e:("string"==typeof r[a[n]]&&(r[a[n]]={}),r=r[a[n]]);else if(n==a.length-1){if("object"!=typeof r)return;r[a[n]]=e}else isNaN(a[n+1])?r[a[n]]={}:r[a[n]]=[],r=r[a[n]]}else"string"==typeof a[n]&&!1==isNaN(a[n])&&(Array.isArray(r)&&Math.abs(a[n])<r.length?n==a.length-1?r[a[n]]=e:r=r[a[n]]:Array.isArray(r)&&a[n]>=r.length&&(n==a.length-1?r.push(e):(r.push({}),r=r[r.length-1])));else"object"==typeof t&&(this.data=Object.assign(this.data,t));return this.data}merge(t,e){if("object"==typeof t&&void 0===e)e=t,t=void 0;else if("string"==typeof t&&"object"==typeof e);else if("object"==typeof t&&"string"==typeof e){let i=t;t=e,e=i}if(void 0===t||""==t)return this.data=Object.assign(this.data,JSON.parse(JSON.stringify(e))),this.data;for(var s=t.split("."),a=this.data,r=0;r<s.length&&void 0!=a;r++)a=Array.isArray(a)&&Math.abs(parseInt(s[r]))<=a.length?0>parseInt(s[r])?a[a.length-Math.abs(parseInt(s[r]))]:a[parseInt(s[r])]:Array.isArray(a)&&Math.abs(parseInt(s[r]))>a.length?this.defaultvalue||void 0:a[s[r]];if(void 0===a&&a==this.defaultvalue)return this.assign(t,e),this.data;if(Array.isArray(a)&&Array.isArray(e))e.forEach(function(t){a.push(t)});else{var n=Object.assign(a,JSON.parse(JSON.stringify(e)));this.data=this.assign(t,n)}return this.data}remove(t,e){if(void 0===e&&(e=!1),""==t||void 0===t)this.clear();else for(var i=t.split("."),s=this.data,a=0;a<i.length&&void 0!=s;a++)if("string"==typeof i[a]&&!0==isNaN(i[a])){if(!Object(s).hasOwnProperty(i[a]))return this.data;a==i.length-1?"object"==typeof s[i[a]]?delete s[i[a]]:e?delete s[i[a]]:s[i[a]]=void 0:s=s[i[a]]}else if("string"==typeof i[a]&&!1==isNaN(i[a])){if(!(Array.isArray(s)&&Math.abs(i[a])<s.length))return this.data;if(a==i.length-1)return s.splice(i[a],1),this.data;s=s[i[a]]}}push(t,e,i=!1){if(""==t||void 0===t)this.data=[this.data],this.data.push(e);else if(t.length>0){let s=this.get(t);void 0===s||i?this.assign(t,[e],void 0,"override"):Array.isArray(s)?s.push(e):("object"==typeof s||"string"==typeof s)&&!1==i&&this.assign(t,[s,e])}return this.data}mergeDeep(t,e,i){if("string"==typeof t?i=i||this.get(t):"object"==typeof t&&(i=e||this.data,e=t),"object"!=typeof e)throw Error("expect an object as input");let s=i||this.data;for(let a in e)if("object"!=typeof e[a])s[a]=e[a];else if("object"==typeof e[a]){if("object"!=typeof s[a])s[a]=e[a];else if(!1===Array.isArray(e[a])&&!1===Array.isArray(s[a]))this.mergeDeep(e[a],s[a]);else if(Array.isArray(e[a])&&Array.isArray(s[a]))for(let r=0;r<Math.max(e[a].length,s[a].length);r++)void 0===e[a][r]||(void 0===s[a][r]?s[a][r]=e[a][r]:"object"!=typeof e[a][r]?-1==s[a].indexOf(e[a][r])&&s[a].push(e[a][r]):this.mergeDeep(e[a][r],s[a][r]))}}replace(t,e,i=!1,s){let a=s||this.data,r;if(i&&(r=RegExp(t)),"object"==typeof a){for(let n in a)if("object"!=typeof a[n])i?r.test(a[n])&&(a[n]=e):a[n]==t&&(a[n]=e);else if("object"==typeof a[n]){if(Array.isArray(a[n])){let o=this,f=a[n].indexOf(t);-1!=f?a[n][f]=e:a[n].forEach(function(s){"object"==typeof s&&o.replace(t,e,i,s)})}else if(void 0!=a[n]&&void 0!==a[n])this.replace(t,e,i,a[n]);else break}}}clear(){this.data={}}}