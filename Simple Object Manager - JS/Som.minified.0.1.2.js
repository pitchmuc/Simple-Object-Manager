"use strict";class Som{constructor(t,e,i=!0){function s(){let t=new WeakSet;return(e,i)=>{if("object"==typeof i&&null!==i){if(t.has(i))return;t.add(i)}return i}}if(this.data={},this.defaultvalue=e,"object"==typeof t&&t instanceof Som==!1){if(Array.isArray(t)&&t.length>0){let a=this.data;t.forEach(function(t){if(i)try{a=Object.assign(a,JSON.parse(JSON.stringify(t)))}catch(e){console.warn("issue assigning object, trying removing circular references."),a=Object.assign(a,JSON.parse(JSON.stringify(t,s())))}else a=Object.assign(a,t)})}else try{i?this.data=Object.assign({},JSON.parse(JSON.stringify(t))):this.data=t}catch(r){console.warn("issue assigning object, trying removing circular references."),this.data=Object.assign({},JSON.parse(JSON.stringify(t,s())))}}else if("object"==typeof t&&t instanceof Som==!0)try{this.data=Object.assign({},JSON.parse(JSON.stringify(t.data)))}catch(o){console.warn("issue assigning object, trying removing circular references."),this.data=Object.assign({},JSON.parse(JSON.stringify(t.data,s())))}}get(t,e){if(void 0===t||""==t)return this.data;let i=[];Array.isArray(t)?i=t:i.push(t);let s={};for(let a of i)s[a]={pathSplit:"",value:void 0};for(let r of i)if("string"==typeof r){s[r].pathSplit=r.split(".");let o=this.data,n=r.split(".");for(var f=0;f<n.length&&void 0!=o;f++)o=Array.isArray(o)&&Math.abs(parseInt(n[f]))<=o.length?0>parseInt(n[f])?o[o.length-Math.abs(parseInt(n[f]))]:o[parseInt(n[f])]:Array.isArray(o)&&Math.abs(parseInt(n[f]))>o.length?e||this.defaultvalue||void 0:o[n[f]];(""===o||void 0===o&&""==e)&&(s[r].value=""),s[r].value=o}let l="";for(let h in s)l=l||s[h].value;return void 0===l&&""==e||""==l?"":l||e||this.defaultvalue||void 0}assign(t,e,i){void 0===e&&(e=i);let s="override"==arguments[3];if(void 0!==t&&""!=t&&"string"==typeof t)for(var a=t.split("."),r=this.data,o=0;o<a.length&&void 0!=r;o++)if("string"==typeof a[o]&&!0==isNaN(a[o])){if(Object(r).hasOwnProperty(a[o]))o==a.length-1?Array.isArray(r[a[o]])?s?r[a[o]]=e:r[a[o]].push(e):r[a[o]]=e:("string"==typeof r[a[o]]&&(r[a[o]]={}),r=r[a[o]]);else if(o==a.length-1){if("object"!=typeof r)return;r[a[o]]=e}else isNaN(a[o+1])?r[a[o]]={}:r[a[o]]=[],r=r[a[o]]}else"string"==typeof a[o]&&!1==isNaN(a[o])&&(Array.isArray(r)&&Math.abs(a[o])<r.length?o==a.length-1?r[a[o]]=e:r=r[a[o]]:Array.isArray(r)&&a[o]>=r.length&&(o==a.length-1?r.push(e):(r.push({}),r=r[r.length-1])));else"object"==typeof t&&(this.data=Object.assign(this.data,t));return this.data}merge(t,e){if("object"==typeof t&&void 0===e)e=t,t=void 0;else if("string"==typeof t&&"object"==typeof e);else if("object"==typeof t&&"string"==typeof e){let i=t;t=e,e=i}if(void 0===t||""==t)return this.data=Object.assign(this.data,JSON.parse(JSON.stringify(e))),this.data;for(var s=t.split("."),a=this.data,r=0;r<s.length&&void 0!=a;r++)a=Array.isArray(a)&&Math.abs(parseInt(s[r]))<=a.length?0>parseInt(s[r])?a[a.length-Math.abs(parseInt(s[r]))]:a[parseInt(s[r])]:Array.isArray(a)&&Math.abs(parseInt(s[r]))>a.length?this.defaultvalue||void 0:a[s[r]];if(void 0===a&&a==this.defaultvalue)return this.assign(t,e),this.data;if(Array.isArray(a)&&Array.isArray(e))e.forEach(function(t){a.push(t)});else{var o=Object.assign(a,JSON.parse(JSON.stringify(e)));this.data=this.assign(t,o)}return this.data}remove(t,e){if(void 0===e&&(e=!1),""==t||void 0===t)this.clear();else for(var i=t.split("."),s=this.data,a=0;a<i.length&&void 0!=s;a++)if("string"==typeof i[a]&&!0==isNaN(i[a])){if(!Object(s).hasOwnProperty(i[a]))return this.data;a==i.length-1?"object"==typeof s[i[a]]?delete s[i[a]]:e?delete s[i[a]]:s[i[a]]=void 0:s=s[i[a]]}else if("string"==typeof i[a]&&!1==isNaN(i[a])){if(!(Array.isArray(s)&&Math.abs(i[a])<s.length))return this.data;if(a==i.length-1)return s.splice(i[a],1),this.data;s=s[i[a]]}}push(t,e,i=!1){if(""==t||void 0===t)this.data=[this.data],this.data.push(e);else if(t.length>0){let s=this.get(t);void 0===s||i?this.assign(t,[e],void 0,"override"):Array.isArray(s)?s.push(e):("object"==typeof s||"string"==typeof s)&&!1==i&&this.assign(t,[s,e])}return this.data}mergeDeep(t,e,i){if("string"==typeof t?i=i||this.get(t):"object"==typeof t&&(i=e||this.data,e=t),"object"!=typeof e)throw Error("expect an object as input");let s=i||this.data;for(let a in e)if("object"!=typeof e[a])s[a]=e[a];else if("object"==typeof e[a]){if("object"!=typeof s[a])s[a]=e[a];else if(!1===Array.isArray(e[a])&&!1===Array.isArray(s[a]))this.mergeDeep(e[a],s[a]);else if(Array.isArray(e[a])&&Array.isArray(s[a]))for(let r=0;r<Math.max(e[a].length,s[a].length);r++)void 0===e[a][r]||(void 0===s[a][r]?s[a][r]=e[a][r]:"object"!=typeof e[a][r]?-1==s[a].indexOf(e[a][r])&&s[a].push(e[a][r]):this.mergeDeep(e[a][r],s[a][r]))}}replace(t,e,i=!1,s){let a=s||this.data,r;if(i&&(r=RegExp(t)),"object"==typeof a){for(let o in a)if("object"!=typeof a[o])i?r.test(a[o])&&(a[o]=e):a[o]==t&&(a[o]=e);else if("object"==typeof a[o]){if(Array.isArray(a[o])){let n=this,f=!1;a[o].length>0&&(f="string"==typeof a[o][0]||"number"==typeof a[o][0]);let l=a[o].indexOf(t);if(-1!=l&&(a[o][l]=e),i&&f)for(l=0;l<a[o].length;l++)r.test(a[o][l])&&(a[o][l]=e);else a[o].forEach(function(s){"object"==typeof s&&n.replace(t,e,i,s)})}else if(void 0!=a[o]&&void 0!==a[o])this.replace(t,e,i,a[o]);else break}}}clear(){this.data={}}}